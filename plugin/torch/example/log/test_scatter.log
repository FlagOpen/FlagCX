NCCL debug information disabled.
torchrun --nproc_per_node 8 --nnodes=1 --node_rank=0 --master_addr="localhost" --master_port=8281 example.py
ddp backend config is cpu:gloo,npu:flagcxddp backend config is cpu:gloo,npu:flagcx

ddp backend config is cpu:gloo,npu:flagcx
ddp backend config is cpu:gloo,npu:flagcx
ddp backend config is cpu:gloo,npu:flagcx
ddp backend config is cpu:gloo,npu:flagcx
ddp backend config is cpu:gloo,npu:flagcx
ddp backend config is cpu:gloo,npu:flagcx
ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]
rank: 1, world_size = 8, prev_rank: 0, next_rank: 2
ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]
rank: 3, world_size = 8, prev_rank: 2, next_rank: 4
ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]
rank: 0, world_size = 8, prev_rank: 7, next_rank: 1
ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]
rank: 2, world_size = 8, prev_rank: 1, next_rank: 3
ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]
rank: 4, world_size = 8, prev_rank: 3, next_rank: 5
ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]
ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]rank: 6, world_size = 8, prev_rank: 5, next_rank: 7

rank: 5, world_size = 8, prev_rank: 4, next_rank: 6
ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]
rank: 7, world_size = 8, prev_rank: 6, next_rank: 0
rank 7 before scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([-1.], device='npu:7'), x_list = [tensor([0.1667], device='npu:7'), tensor([0.3877], device='npu:7'), tensor([0.8311], device='npu:7'), tensor([0.6489], device='npu:7'), tensor([0.2265], device='npu:7'), tensor([0.7814], device='npu:7'), tensor([0.6640], device='npu:7'), tensor([0.3085], device='npu:7')]
p-perf-huawei-06:3959153:3959153 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
rank 0 before scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([-1.], device='npu:0'), x_list = [tensor([0.8121], device='npu:0'), tensor([0.9015], device='npu:0'), tensor([0.4076], device='npu:0'), tensor([0.4441], device='npu:0'), tensor([0.0398], device='npu:0'), tensor([0.4384], device='npu:0'), tensor([0.7918], device='npu:0'), tensor([0.1841], device='npu:0')]
p-perf-huawei-06:3959146:3959146 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
p-perf-huawei-06:3959146:3959957 [0] FLAGCX INFO Bootstrap Root : rank 0 of 8 ranks checked in
p-perf-huawei-06:3959146:3959957 [0] FLAGCX INFO Bootstrap Root : rank 7 of 8 ranks checked in
rank 6 before scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([-1.], device='npu:6'), x_list = [tensor([0.7336], device='npu:6'), tensor([0.1234], device='npu:6'), tensor([0.9644], device='npu:6'), tensor([0.0656], device='npu:6'), tensor([0.6321], device='npu:6'), tensor([0.6076], device='npu:6'), tensor([0.9188], device='npu:6'), tensor([0.4546], device='npu:6')]
p-perf-huawei-06:3959152:3959152 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
p-perf-huawei-06:3959146:3959957 [0] FLAGCX INFO Bootstrap Root : rank 6 of 8 ranks checked in
rank 5 before scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([-1.], device='npu:5'), x_list = [tensor([0.6105], device='npu:5'), tensor([0.6369], device='npu:5'), tensor([0.7548], device='npu:5'), tensor([0.5356], device='npu:5'), tensor([0.1574], device='npu:5'), tensor([0.0829], device='npu:5'), tensor([0.9506], device='npu:5'), tensor([0.7816], device='npu:5')]
p-perf-huawei-06:3959151:3959151 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
p-perf-huawei-06:3959146:3959957 [0] FLAGCX INFO Bootstrap Root : rank 5 of 8 ranks checked in
rank 2 before scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([-1.], device='npu:2'), x_list = [tensor([0.2843], device='npu:2'), tensor([0.5711], device='npu:2'), tensor([0.0511], device='npu:2'), tensor([0.5942], device='npu:2'), tensor([0.8288], device='npu:2'), tensor([0.5264], device='npu:2'), tensor([0.6659], device='npu:2'), tensor([0.7636], device='npu:2')]
p-perf-huawei-06:3959148:3959148 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
p-perf-huawei-06:3959146:3959957 [0] FLAGCX INFO Bootstrap Root : rank 2 of 8 ranks checked in
rank 3 before scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([-1.], device='npu:3'), x_list = [tensor([0.2351], device='npu:3'), tensor([0.1747], device='npu:3'), tensor([0.0018], device='npu:3'), tensor([0.1194], device='npu:3'), tensor([0.4491], device='npu:3'), tensor([0.2718], device='npu:3'), tensor([0.4014], device='npu:3'), tensor([0.1010], device='npu:3')]
p-perf-huawei-06:3959149:3959149 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
p-perf-huawei-06:3959146:3959957 [0] FLAGCX INFO Bootstrap Root : rank 3 of 8 ranks checked in
rank 4 before scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([-1.], device='npu:4'), x_list = [tensor([0.2637], device='npu:4'), tensor([0.8878], device='npu:4'), tensor([0.0476], device='npu:4'), tensor([0.0393], device='npu:4'), tensor([0.1998], device='npu:4'), tensor([0.7787], device='npu:4'), tensor([0.9467], device='npu:4'), tensor([0.1476], device='npu:4')]
p-perf-huawei-06:3959150:3959150 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
p-perf-huawei-06:3959146:3959957 [0] FLAGCX INFO Bootstrap Root : rank 4 of 8 ranks checked in
rank 1 before scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([-1.], device='npu:1'), x_list = [tensor([0.9843], device='npu:1'), tensor([0.0962], device='npu:1'), tensor([0.6908], device='npu:1'), tensor([0.4617], device='npu:1'), tensor([0.2046], device='npu:1'), tensor([0.0277], device='npu:1'), tensor([0.4065], device='npu:1'), tensor([0.8161], device='npu:1')]
p-perf-huawei-06:3959147:3959147 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
p-perf-huawei-06:3959146:3959957 [0] FLAGCX INFO Bootstrap Root : rank 1 of 8 ranks checked in
p-perf-huawei-06:3959146:3959957 [0] FLAGCX INFO SENT OUT ALL 8 HANDLES
p-perf-huawei-06:3959153:3959153 [0] FLAGCX INFO rank 7 nranks 8 - DONE
p-perf-huawei-06:3959148:3959148 [0] FLAGCX INFO rank 2 nranks 8 - DONE
p-perf-huawei-06:3959152:3959152 [0] FLAGCX INFO rank 6 nranks 8 - DONE
p-perf-huawei-06:3959146:3959146 [0] FLAGCX INFO rank 0 nranks 8 - DONE
p-perf-huawei-06:3959151:3959151 [0] FLAGCX INFO rank 5 nranks 8 - DONE
p-perf-huawei-06:3959149:3959149 [0] FLAGCX INFO rank 3 nranks 8 - DONE
p-perf-huawei-06:3959150:3959150 [0] FLAGCX INFO rank 4 nranks 8 - DONE
p-perf-huawei-06:3959147:3959147 [0] FLAGCX INFO rank 1 nranks 8 - DONE
p-perf-huawei-06:3959146:3959146 [0] FLAGCX INFO rank = 0, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 0, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
p-perf-huawei-06:3959149:3959149 [0] FLAGCX INFO rank = 3, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 3, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
p-perf-huawei-06:3959150:3959150 [0] FLAGCX INFO rank = 4, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 4, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
p-perf-huawei-06:3959152:3959152 [0] FLAGCX INFO rank = 6, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 6, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
p-perf-huawei-06:3959147:3959147 [0] FLAGCX INFO rank = 1, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 1, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
p-perf-huawei-06:3959148:3959148 [0] FLAGCX INFO rank = 2, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 2, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
p-perf-huawei-06:3959151:3959151 [0] FLAGCX INFO rank = 5, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 5, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
p-perf-huawei-06:3959153:3959153 [0] FLAGCX INFO rank = 7, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 7, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
rank 2 after scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([-1.], device='npu:2'), x_list = [tensor([0.2843], device='npu:2'), tensor([0.5711], device='npu:2'), tensor([0.0511], device='npu:2'), tensor([0.5942], device='npu:2'), tensor([0.8288], device='npu:2'), tensor([0.5264], device='npu:2'), tensor([0.6659], device='npu:2'), tensor([0.7636], device='npu:2')]
rank 1 after scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([-1.], device='npu:1'), x_list = [tensor([0.9843], device='npu:1'), tensor([0.0962], device='npu:1'), tensor([0.6908], device='npu:1'), tensor([0.4617], device='npu:1'), tensor([0.2046], device='npu:1'), tensor([0.0277], device='npu:1'), tensor([0.4065], device='npu:1'), tensor([0.8161], device='npu:1')]
rank 5 after scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([-1.], device='npu:5'), x_list = [tensor([0.6105], device='npu:5'), tensor([0.6369], device='npu:5'), tensor([0.7548], device='npu:5'), tensor([0.5356], device='npu:5'), tensor([0.1574], device='npu:5'), tensor([0.0829], device='npu:5'), tensor([0.9506], device='npu:5'), tensor([0.7816], device='npu:5')]
rank 6 after scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([-1.], device='npu:6'), x_list = [tensor([0.7336], device='npu:6'), tensor([0.1234], device='npu:6'), tensor([0.9644], device='npu:6'), tensor([0.0656], device='npu:6'), tensor([0.6321], device='npu:6'), tensor([0.6076], device='npu:6'), tensor([0.9188], device='npu:6'), tensor([0.4546], device='npu:6')]
rank 3 after scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([-1.], device='npu:3'), x_list = [tensor([0.2351], device='npu:3'), tensor([0.1747], device='npu:3'), tensor([0.0018], device='npu:3'), tensor([0.1194], device='npu:3'), tensor([0.4491], device='npu:3'), tensor([0.2718], device='npu:3'), tensor([0.4014], device='npu:3'), tensor([0.1010], device='npu:3')]
rank 0 after scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([-1.], device='npu:0'), x_list = [tensor([0.8121], device='npu:0'), tensor([0.9015], device='npu:0'), tensor([0.4076], device='npu:0'), tensor([0.4441], device='npu:0'), tensor([0.0398], device='npu:0'), tensor([0.4384], device='npu:0'), tensor([0.7918], device='npu:0'), tensor([0.1841], device='npu:0')]
rank 7 after scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([ 0.], device='npu:7'), x_list = [tensor([0.1667], device='npu:7'), tensor([0.3877], device='npu:7'), tensor([0.8311], device='npu:7'), tensor([0.6489], device='npu:7'), tensor([0.2265], device='npu:7'), tensor([0.7814], device='npu:7'), tensor([0.6640], device='npu:7'), tensor([0.3085], device='npu:7')]
rank 4 after scatter from src rank 0 with FLAGCX_GROUP2: z = tensor([ 0.], device='npu:4'), x_list = [tensor([0.2637], device='npu:4'), tensor([0.8878], device='npu:4'), tensor([0.0476], device='npu:4'), tensor([0.0393], device='npu:4'), tensor([0.1998], device='npu:4'), tensor([0.7787], device='npu:4'), tensor([0.9467], device='npu:4'), tensor([0.1476], device='npu:4')]
