NCCL debug information disabled.
torchrun --nproc_per_node 8 --nnodes=1 --node_rank=0 --master_addr="localhost" --master_port=8281 example.py
ddp backend config is cpu:gloo,npu:flagcx
ddp backend config is cpu:gloo,npu:flagcx
ddp backend config is cpu:gloo,npu:flagcx
ddp backend config is cpu:gloo,npu:flagcx
ddp backend config is cpu:gloo,npu:flagcx
ddp backend config is cpu:gloo,npu:flagcx
ddp backend config is cpu:gloo,npu:flagcx
ddp backend config is cpu:gloo,npu:flagcx
ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]
rank: 0, world_size = 8, prev_rank: 7, next_rank: 1
ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]

rank: 1, world_size = 8, prev_rank: 0, next_rank: 2
rank: 2, world_size = 8, prev_rank: 1, next_rank: 3
ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]
rank: 5, world_size = 8, prev_rank: 4, next_rank: 6
ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]
rank: 3, world_size = 8, prev_rank: 2, next_rank: 4
ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]
rank: 6, world_size = 8, prev_rank: 5, next_rank: 7ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]

rank: 4, world_size = 8, prev_rank: 3, next_rank: 5
ranks_flagcx: [0, 1, 2, 3, 4, 5, 6, 7]
rank: 7, world_size = 8, prev_rank: 6, next_rank: 0
rank 5 before broadcast with FLAGCX_GROUP2: x = tensor([0.8672, 0.9236, 0.8867, 0.5452, 0.5197, 0.7698, 0.5541, 0.0218],
       device='npu:5')
rank 4 before broadcast with FLAGCX_GROUP2: x = tensor([0.4781, 0.7788, 0.5544, 0.7617, 0.4649, 0.4878, 0.2041, 0.2914],
       device='npu:4')
p-perf-huawei-06:3942372:3942372 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
p-perf-huawei-06:3942371:3942371 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
rank 0 before broadcast with FLAGCX_GROUP2: x = tensor([0.0460, 0.8802, 0.2840, 0.2636, 0.1115, 0.1733, 0.1039, 0.9695],
       device='npu:0')
p-perf-huawei-06:3942367:3942367 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
p-perf-huawei-06:3942367:3943506 [0] FLAGCX INFO Bootstrap Root : rank 0 of 8 ranks checked in
p-perf-huawei-06:3942367:3943506 [0] FLAGCX INFO Bootstrap Root : rank 4 of 8 ranks checked in
p-perf-huawei-06:3942367:3943506 [0] FLAGCX INFO Bootstrap Root : rank 5 of 8 ranks checked in
rank 6 before broadcast with FLAGCX_GROUP2: x = tensor([0.7573, 0.4007, 0.3410, 0.5881, 0.5271, 0.1611, 0.1721, 0.8827],
       device='npu:6')
p-perf-huawei-06:3942373:3942373 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
p-perf-huawei-06:3942367:3943506 [0] FLAGCX INFO Bootstrap Root : rank 6 of 8 ranks checked in
rank 7 before broadcast with FLAGCX_GROUP2: x = tensor([0.8701, 0.5147, 0.2144, 0.1216, 0.0235, 0.2436, 0.1351, 0.1413],
       device='npu:7')
p-perf-huawei-06:3942374:3942374 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
p-perf-huawei-06:3942367:3943506 [0] FLAGCX INFO Bootstrap Root : rank 7 of 8 ranks checked in
rank 3 before broadcast with FLAGCX_GROUP2: x = tensor([0.2670, 0.9520, 0.1362, 0.9770, 0.5605, 0.6445, 0.2728, 0.8729],
       device='npu:3')
p-perf-huawei-06:3942370:3942370 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
p-perf-huawei-06:3942367:3943506 [0] FLAGCX INFO Bootstrap Root : rank 3 of 8 ranks checked in
rank 2 before broadcast with FLAGCX_GROUP2: x = tensor([0.1272, 0.4881, 0.6207, 0.1194, 0.5309, 0.8870, 0.2765, 0.4035],
       device='npu:2')
p-perf-huawei-06:3942369:3942369 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
p-perf-huawei-06:3942367:3943506 [0] FLAGCX INFO Bootstrap Root : rank 2 of 8 ranks checked in
rank 1 before broadcast with FLAGCX_GROUP2: x = tensor([0.8161, 0.4906, 0.7031, 0.3311, 0.5059, 0.6070, 0.6349, 0.6906],
       device='npu:1')
p-perf-huawei-06:3942368:3942368 [0] FLAGCX INFO Bootstrap : Using enp196s0f0:10.1.15.130<0>
p-perf-huawei-06:3942367:3943506 [0] FLAGCX INFO Bootstrap Root : rank 1 of 8 ranks checked in
p-perf-huawei-06:3942367:3943506 [0] FLAGCX INFO SENT OUT ALL 8 HANDLES
p-perf-huawei-06:3942373:3942373 [0] FLAGCX INFO rank 6 nranks 8 - DONE
p-perf-huawei-06:3942374:3942374 [0] FLAGCX INFO rank 7 nranks 8 - DONE
p-perf-huawei-06:3942367:3942367 [0] FLAGCX INFO rank 0 nranks 8 - DONE
p-perf-huawei-06:3942370:3942370 [0] FLAGCX INFO rank 3 nranks 8 - DONE
p-perf-huawei-06:3942372:3942372 [0] FLAGCX INFO rank 5 nranks 8 - DONE
p-perf-huawei-06:3942371:3942371 [0] FLAGCX INFO rank 4 nranks 8 - DONE
p-perf-huawei-06:3942369:3942369 [0] FLAGCX INFO rank 2 nranks 8 - DONE
p-perf-huawei-06:3942368:3942368 [0] FLAGCX INFO rank 1 nranks 8 - DONE
p-perf-huawei-06:3942367:3942367 [0] FLAGCX INFO rank = 0, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 0, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
p-perf-huawei-06:3942369:3942369 [0] FLAGCX INFO rank = 2, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 2, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
p-perf-huawei-06:3942371:3942371 [0] FLAGCX INFO rank = 4, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 4, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
p-perf-huawei-06:3942374:3942374 [0] FLAGCX INFO rank = 7, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 7, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
p-perf-huawei-06:3942368:3942368 [0] FLAGCX INFO rank = 1, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 1, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
p-perf-huawei-06:3942372:3942372 [0] FLAGCX INFO rank = 5, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 5, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
p-perf-huawei-06:3942373:3942373 [0] FLAGCX INFO rank = 6, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 6, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
p-perf-huawei-06:3942370:3942370 [0] FLAGCX INFO rank = 3, nranks = 8, nclusters = 1, cluster_id = 0, cluster_size = 8, cluster_inter_rank = -1, homo_rank = 3, homo_root_rank = 0, homo_inter_rank = -1, homo_ranks = 8, has_single_rank_homo_comm = 0, 
rank 6 after broadcast with FLAGCX_GROUP2: x = tensor([0.7573, 0.4007, 0.3410, 0.5881, 0.5271, 0.1611, 0.1721, 0.8827],
       device='npu:6')
rank 2 after broadcast with FLAGCX_GROUP2: x = tensor([0.1272, 0.4881, 0.6207, 0.1194, 0.5309, 0.8870, 0.2765, 0.4035],
       device='npu:2')
rank 1 after broadcast with FLAGCX_GROUP2: x = tensor([0.8161, 0.4906, 0.7031, 0.3311, 0.5059, 0.6070, 0.6349, 0.6906],
       device='npu:1')
rank 5 after broadcast with FLAGCX_GROUP2: x = tensor([0.8672, 0.9236, 0.8867, 0.5452, 0.5197, 0.7698, 0.5541, 0.0218],
       device='npu:5')
rank 7 after broadcast with FLAGCX_GROUP2: x = tensor([0.8701, 0.5147, 0.2144, 0.1216, 0.0235, 0.2436, 0.1351, 0.1413],
       device='npu:7')
rank 3 after broadcast with FLAGCX_GROUP2: x = tensor([0.2670, 0.9520, 0.1362, 0.9770, 0.5605, 0.6445, 0.2728, 0.8729],
       device='npu:3')
rank 4 after broadcast with FLAGCX_GROUP2: x = tensor([0.4781, 0.7788, 0.5544, 0.7617, 0.4649, 0.4878, 0.2041, 0.2914],
       device='npu:4')
rank 0 after broadcast with FLAGCX_GROUP2: x = tensor([0.0460, 0.8802, 0.2840, 0.2636, 0.1115, 0.1733, 0.1039, 0.9695],
       device='npu:0')
